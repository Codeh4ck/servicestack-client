var __assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd?define(["require","exports","fetch-everywhere"],e):"undefined"!=typeof window&&e(window.require||function(){},window["@servicestack/client"]={})}(function(e,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),e("fetch-everywhere");var o=function(e){Object.assign(this,e)};O.ResponseStatus=o;function t(e){Object.assign(this,e)}O.ResponseError=t;var s=function(e){Object.assign(this,e)};O.ErrorResponse=s;var i=(r.prototype.tryResolve=function(e){return new e},r);function r(){}O.NewInstanceResolver=i;var n=(a.prototype.tryResolve=function(e){return e.instance||(e.instance=new e)},a);function a(){}O.SingletonInstanceResolver=n;var u,T={onConnect:"ServerEventConnect",onHeartbeat:"ServerEventHeartbeat",onJoin:"ServerEventJoin",onLeave:"ServerEventLeave",onUpdate:"ServerEventUpdate"};(u=O.ReadyState||(O.ReadyState={}))[u.CONNECTING=0]="CONNECTING",u[u.OPEN=1]="OPEN",u[u.CLOSED=2]="CLOSED";var l=(c.prototype.getEventSourceOptions=function(){return{withCredentials:this.withCredentials}},c.prototype.reconnectServerEvents=function(t){var r=this;if(void 0===t&&(t={}),!this.stopped){t.error&&this.onError(t.error);var n=this.eventSource,e=t.url||this.eventStreamUri||n.url;null!=this.options.resolveStreamUrl&&(e=this.options.resolveStreamUrl(e));var o=this.EventSource?new this.EventSource(e,this.getEventSourceOptions()):new EventSource(e,this.getEventSourceOptions());o.addEventListener("error",function(e){return t.onerror||n.onerror||r.onError}),o.addEventListener("message",t.onmessage||n.onmessage||this.onMessage);var i=this.options.onReconnect;return null!=i&&i.call(o,t.error),n.removeEventListener&&(n.removeEventListener("error",this.onError),n.removeEventListener("message",this.onMessage)),n.close(),this.eventSource=o}},c.prototype.start=function(){var t=this;if(this.stopped=!1,null==this.eventSource||this.eventSource.readyState===EventSource.CLOSED){var e=this.eventStreamUri;null!=this.options.resolveStreamUrl&&(e=this.options.resolveStreamUrl(e)),this.eventSource=this.EventSource?new this.EventSource(e,this.getEventSourceOptions()):new EventSource(e,this.getEventSourceOptions()),this.eventSource.addEventListener("error",this.onError),this.eventSource.addEventListener("message",function(e){return t.onMessage(e)})}return this},c.prototype.stop=function(){this.stopped=!0,this.eventSource&&this.eventSource.close();var e=this.options;e&&e.heartbeat&&clearInterval(e.heartbeat);var t=this.connectionInfo;return null==t||null==t.unRegisterUrl?new Promise(function(e,t){return e()}):(this.connectionInfo=null,fetch(new Request(t.unRegisterUrl,{method:"POST",mode:"cors",credentials:this.serviceClient.credentials})).then(function(e){if(!e.ok)throw new Error(e.status+" - "+e.statusText)}).catch(this.onError))},c.prototype.invokeReceiver=function(e,t,r,n,o){if(e)if("function"==typeof e&&(e=this.resolver.tryResolve(e)),t=t.replace("-",""),e.client=this,e.request=n,"function"==typeof e[t])e[t].call(r||e,n.body,n);else if(t in e)e[t]=n.body;else{var i=t.toLowerCase();for(var s in e)if(s.toLowerCase()==i)return void("function"==typeof e[s]?e[s].call(r||e,n.body,n):e[s]=n.body);var a=e.noSuchMethod;"function"==typeof a&&a.call(r||e,n.target,n)}},c.prototype.hasConnected=function(){return null!=this.connectionInfo},c.prototype.registerHandler=function(e,t){return this.options.handlers||(this.options.handlers={}),this.options.handlers[e]=t,this},c.prototype.setResolver=function(e){return this.options.resolver=e,this},c.prototype.registerReceiver=function(e){return this.registerNamedReceiver("cmd",e)},c.prototype.registerNamedReceiver=function(e,t){return this.options.receivers||(this.options.receivers={}),this.options.receivers[e]=t,this},c.prototype.unregisterReceiver=function(e){return void 0===e&&(e="cmd"),this.options.receivers&&delete this.options.receivers[e],this},c.prototype.updateChannels=function(e){this.channels=e;var t=null!=this.eventSource?this.eventSource.url:this.eventStreamUri;this.eventStreamUri=t.substring(0,Math.min(t.indexOf("?"),t.length))+"?channels="+e.join(",")+"&t="+(new Date).getTime()},c.prototype.update=function(e,t){var r="string"==typeof e?e.split(","):e,n="string"==typeof t?t.split(","):t,o=[];for(var i in this.channels){var s=this.channels[i];null!=n&&-1!==n.indexOf(s)||o.push(s)}if(r)for(var i in r)s=r[i],-1===o.indexOf(s)&&o.push(s);this.updateChannels(o)},c.prototype.addListener=function(e,t){return(this.listeners[e]||(this.listeners[e]=[])).push(t),this},c.prototype.removeListener=function(e,t){var r=this.listeners[e];if(r){var n=r.indexOf(t);0<=n&&r.splice(n,1)}return this},c.prototype.raiseEvent=function(e,t){var r=this,n=this.listeners[e];n&&n.forEach(function(e){try{e(t)}catch(e){r.onError(e)}})},c.prototype.getConnectionInfo=function(){if(null==this.connectionInfo)throw"Not Connected";return this.connectionInfo},c.prototype.getSubscriptionId=function(){return this.getConnectionInfo().id},c.prototype.updateSubscriber=function(t){var r=this;return null==t.id&&(t.id=this.getSubscriptionId()),this.serviceClient.post(t).then(function(e){r.update(t.subscribeChannels,t.unsubscribeChannels)}).catch(this.onError)},c.prototype.subscribeToChannels=function(){for(var t=this,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=new p;return n.id=this.getSubscriptionId(),n.subscribeChannels=r,this.serviceClient.post(n).then(function(e){t.update(r,null)}).catch(this.onError)},c.prototype.unsubscribeFromChannels=function(){for(var t=this,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=new p;return n.id=this.getSubscriptionId(),n.unsubscribeChannels=r,this.serviceClient.post(n).then(function(e){t.update(null,r)}).catch(this.onError)},c.prototype.getChannelSubscribers=function(){var t=this,e=new m;return e.channels=this.channels,this.serviceClient.get(e).then(function(e){return e.map(function(e){return t.toServerEventUser(e)})}).catch(function(e){return t.onError(e),[]})},c.prototype.toServerEventUser=function(e){var t=e.channels,r=new g;for(var n in r.userId=e.userId,r.displayName=e.displayName,r.profileUrl=e.profileUrl,r.channels=t?t.split(","):null,e)"userId"!=n&&"displayName"!=n&&"profileUrl"!=n&&"channels"!=n&&(null==r.meta&&(r.meta={}),r.meta[n]=e[n]);return r},c.UnknownChannel="*",c);function c(e,t,r,n){void 0===r&&(r={}),void 0===n&&(n=null);var C=this;if(this.channels=t,this.options=r,this.eventSource=n,this.onMessage=function(e){if(!C.stopped){var t=C.options;if(void 0===r)var r={querySelectorAll:function(e){return[]}};var n=r.querySelectorAll.bind(r),o=O.splitOnFirst(e.data," "),i=null,s=o[0],a=O.splitOnFirst(s,"@");1<a.length&&(i=a[0],s=a[1]);var u=o[1],l=null;try{l=u?JSON.parse(u):null}catch(e){}if((o=O.splitOnFirst(s,".")).length<=1)throw"invalid selector format: "+s;var c=o[0],f=o[1].replace(new RegExp("%20","g")," "),h=O.splitOnFirst(f,"$"),p=h[0],d=h[1],v=d&&n(d),m=v&&v[0],y={eventId:parseInt(e.lastEventId),data:e.data,type:T[p]||"ServerEventMessage",channel:i,selector:s,json:u,body:l,op:c,target:h[0],cssSelector:d,meta:{}},g="object"==typeof l?Object.assign({},y,l):y;if(!t.validate||!1!==t.validate(y)){var b=new Headers;if(b.set("Content-Type","text/plain"),"cmd"===c)if("onConnect"===p){if(C.connectionInfo=g,"string"==typeof l.heartbeatIntervalMs&&(C.connectionInfo.heartbeatIntervalMs=parseInt(l.heartbeatIntervalMs)),"string"==typeof l.idleTimeoutMs&&(C.connectionInfo.idleTimeoutMs=parseInt(l.idleTimeoutMs)),Object.assign(t,l),(w=t.handlers.onConnect)&&(w.call(m||r.body,C.connectionInfo,y),C.stopped))return;t.heartbeatUrl&&(t.heartbeat&&clearInterval(t.heartbeat),t.heartbeat=setInterval(function(){if(C.eventSource.readyState===EventSource.CLOSED){clearInterval(t.heartbeat);var e=t.handlers.onStop;return null!=e&&e.apply(C.eventSource),void C.reconnectServerEvents({error:new Error("EventSource is CLOSED")})}fetch(new Request(t.heartbeatUrl,{method:"POST",mode:"cors",headers:b,credentials:C.serviceClient.credentials})).then(function(e){if(!e.ok)throw new Error(e.status+" - "+e.statusText)}).catch(function(e){return C.reconnectServerEvents({error:e})})},C.connectionInfo&&C.connectionInfo.heartbeatIntervalMs||t.heartbeatIntervalMs||1e4)),t.unRegisterUrl&&"undefined"!=typeof window&&(window.onunload=function(){return C.stop()}),C.updateSubscriberUrl=t.updateSubscriberUrl,C.updateChannels((t.channels||"").split(","))}else{var E="onJoin"==p||"onLeave"==p||"onUpdate"==p;if(w=t.handlers[p])E?w.call(m||r.body,g):w.call(m||r.body,l,y);else if(!E){var S=t.receivers&&t.receivers.cmd;C.invokeReceiver(S,p,m,y,"cmd")}E&&(w=t.handlers.onCommand)&&w.call(m||r.body,g)}else"trigger"===c?C.raiseEvent(f,y):"css"===c&&O.css(v||n("body"),p,l);var w;S=t.receivers&&t.receivers[c];if(C.invokeReceiver(S,p,m,y,c),!T[p])(w=t.handlers.onMessage)&&w.call(m||r.body,g);t.onTick&&t.onTick()}}},this.onError=function(e){if(!C.stopped){e||(e=event);var t=C.options.onException;null!=t&&t.call(C.eventSource,e),C.options.onTick&&C.options.onTick()}},0===this.channels.length)throw"at least 1 channel is required";this.resolver=this.options.resolver||new i,this.eventStreamUri=O.combinePaths(e,"event-stream")+"?",this.updateChannels(t),this.serviceClient=new k(e),this.listeners={},this.withCredentials=!0,this.options.handlers||(this.options.handlers={})}O.ServerEventsClient=l;var f=(h.prototype.noSuchMethod=function(e,t){},h);function h(){}O.ServerEventReceiver=f;var p=(d.prototype.createResponse=function(){return new v},d.prototype.getTypeName=function(){return"UpdateEventSubscriber"},d);function d(){}O.UpdateEventSubscriber=p;var v=function(){};O.UpdateEventSubscriberResponse=v;var m=(y.prototype.createResponse=function(){return[]},y.prototype.getTypeName=function(){return"GetEventSubscribers"},y);function y(){}O.GetEventSubscribers=m;var g=function(){};O.ServerEventUser=g;var b=(E.Get="GET",E.Post="POST",E.Put="PUT",E.Delete="DELETE",E.Patch="PATCH",E.Head="HEAD",E.Options="OPTIONS",E.hasRequestBody=function(e){return!("GET"===e||"DELETE"===e||"HEAD"===e||"OPTIONS"===e)},E);function E(){}O.HttpMethods=b;var S=(w.prototype.createResponse=function(){return new C},w.prototype.getTypeName=function(){return"GetAccessToken"},w);function w(){}var C=function(){};O.GetAccessTokenResponse=C;var k=(U.prototype.setCredentials=function(e,t){this.userName=e,this.password=t},U.prototype.setBearerToken=function(e){this.bearerToken=e},U.prototype.get=function(e,t){return"string"!=typeof e?this.send(b.Get,e,t):this.send(b.Get,null,t,this.toAbsoluteUrl(e))},U.prototype.delete=function(e,t){return"string"!=typeof e?this.send(b.Delete,e,t):this.send(b.Delete,null,t,this.toAbsoluteUrl(e))},U.prototype.post=function(e,t){return this.send(b.Post,e,t)},U.prototype.postToUrl=function(e,t,r){return this.send(b.Post,t,r,this.toAbsoluteUrl(e))},U.prototype.postBody=function(e,t,r){return this.sendBody(b.Post,e,t,r)},U.prototype.put=function(e,t){return this.send(b.Put,e,t)},U.prototype.putToUrl=function(e,t,r){return this.send(b.Put,t,r,this.toAbsoluteUrl(e))},U.prototype.putBody=function(e,t,r){return this.sendBody(b.Put,e,t,r)},U.prototype.patch=function(e,t){return this.send(b.Patch,e,t)},U.prototype.patchToUrl=function(e,t,r){return this.send(b.Patch,t,r,this.toAbsoluteUrl(e))},U.prototype.patchBody=function(e,t,r){return this.sendBody(b.Patch,e,t,r)},U.prototype.sendAll=function(e){if(0==e.length)return Promise.resolve([]);var t=O.combinePaths(this.replyBaseUrl,O.nameOf(e[0])+"[]");return this.send(b.Post,e,null,t)},U.prototype.sendAllOneWay=function(e){if(0==e.length)return Promise.resolve(void 0);var t=O.combinePaths(this.oneWayBaseUrl,O.nameOf(e[0])+"[]");return this.send(b.Post,e,null,t).then(function(e){})},U.prototype.createUrlFromDto=function(e,t){var r=O.combinePaths(this.replyBaseUrl,O.nameOf(t));return b.hasRequestBody(e)||(r=O.appendQueryString(r,t)),r},U.prototype.toAbsoluteUrl=function(e){return e.startsWith("http://")||e.startsWith("https://")?e:O.combinePaths(this.baseUrl,e)},U.prototype.createRequest=function(e){var r=this,t=e.method,n=e.request,o=e.url,i=e.args,s=e.body;if(o||(o=this.createUrlFromDto(t,n)),i&&(o=O.appendQueryString(o,i)),null!=this.bearerToken?this.headers.set("Authorization","Bearer "+this.bearerToken):null!=this.userName&&this.headers.set("Authorization","Basic "+U.toBase64(this.userName+":"+this.password)),this.manageCookies){var a=Object.keys(this.cookies).map(function(e){var t=r.cookies[e];return t.expires&&t.expires<new Date?null:t.name+"="+encodeURIComponent(t.value)}).filter(function(e){return!!e});0<a.length?this.headers.set("Cookie",a.join("; ")):this.headers.delete("Cookie")}var u=new Headers(this.headers),l=b.hasRequestBody(t),c={url:o,method:t,mode:this.mode,credentials:this.credentials,headers:u,compress:!1};return l&&(c.body=s||JSON.stringify(n),"undefined"!=typeof window&&s instanceof FormData&&u.delete("Content-Type")),null!=this.requestFilter&&this.requestFilter(c),c},U.prototype.createResponse=function(e,t){var r=this;if(!e.ok)throw e;if(this.manageCookies){var n=[];e.headers.forEach(function(e,t){"set-cookie"==t.toLowerCase()&&n.push(e)}),n.forEach(function(e){var t=O.parseCookie(e);t&&(r.cookies[t.name]=t)})}null!=this.responseFilter&&this.responseFilter(e);var o=t&&"string"!=typeof t&&"function"==typeof t.createResponse?t.createResponse():null;if("string"==typeof o)return e.text().then(function(e){return e});var i=e.headers.get("content-type"),s=i&&-1!==i.indexOf("application/json");if(s)return e.json().then(function(e){return e});if("undefined"!=typeof Uint8Array&&o instanceof Uint8Array){if("function"!=typeof e.arrayBuffer)throw new Error("This fetch polyfill does not implement 'arrayBuffer'");return e.arrayBuffer().then(function(e){return new Uint8Array(e)})}if("function"==typeof Blob&&o instanceof Blob){if("function"!=typeof e.blob)throw new Error("This fetch polyfill does not implement 'blob'");return e.blob().then(function(e){return e})}var a=e.headers.get("content-length");return"0"===a||null==a&&!s?o:e.json().then(function(e){return e})},U.prototype.handleError=function(e,r,n){var o=this;if(void 0===n&&(n=null),r instanceof Error)throw this.raiseError(e,r);if(r.bodyUsed)throw this.raiseError(r,R(r.status,r.statusText,n));return void 0===r.json&&r.responseStatus?new Promise(function(e,t){return t(o.raiseError(null,r))}):r.json().then(function(e){var t=O.sanitize(e);if(!t.responseStatus)throw R(r.status,r.statusText,n);throw null!=n&&(t.type=n),t}).catch(function(e){if(e instanceof Error||"undefined"!=typeof window&&e instanceof window.DOMException)throw o.raiseError(r,R(r.status,r.statusText,n));throw o.raiseError(r,e)})},U.prototype.send=function(e,t,r,n){return this.sendRequest({method:e,request:t,args:r,url:n})},U.prototype.sendBody=function(e,t,r,n){var o=O.combinePaths(this.replyBaseUrl,O.nameOf(t));return this.sendRequest({method:e,request:r,body:"string"==typeof r?r:"undefined"!=typeof window&&r instanceof FormData?r:JSON.stringify(r),url:O.appendQueryString(o,t),args:n,returns:t})},U.prototype.sendRequest=function(t){function o(){var e=i.createRequest(t);return i.urlFilter&&i.urlFilter(e.url),fetch(e.url,e).then(function(e){return i.createResponse(e,r)}).catch(function(e){return i.handleError(s,e)})}var i=this,e=this.createRequest(t),r=t.returns||t.request,s=null;return this.urlFilter&&this.urlFilter(e.url),fetch(e.url,e).then(function(e){return s=e,i.createResponse(e,r)}).catch(function(e){if(401===e.status){if(i.refreshToken){var t=new S;t.refreshToken=i.refreshToken;var r=i.refreshTokenUri||i.createUrlFromDto(b.Post,t),n=i.createRequest({method:b.Post,request:t,args:null,url:r});return fetch(r,n).then(function(e){return i.createResponse(e,t).then(function(e){return i.bearerToken=e.accessToken,o()})}).catch(function(e){return i.handleError(s,e,"RefreshTokenException")})}if(i.onAuthenticationRequired)return i.onAuthenticationRequired().then(o)}return i.handleError(s,e)})},U.prototype.raiseError=function(e,t){return null!=this.exceptionFilter&&this.exceptionFilter(e,t),t},U);function U(e){void 0===e&&(e="/"),this.baseUrl=e,this.replyBaseUrl=O.combinePaths(e,"json","reply")+"/",this.oneWayBaseUrl=O.combinePaths(e,"json","oneway")+"/",this.mode="cors",this.credentials="include",this.headers=new Headers,this.headers.set("Content-Type","application/json"),this.manageCookies="undefined"==typeof document,this.cookies={}}O.JsonServiceClient=k;var R=function(e,t,r){void 0===r&&(r=null);var n=new s;return null!=r&&(n.type=r),n.responseStatus=new o,n.responseStatus.errorCode=e&&e.toString(),n.responseStatus.message=t,n};O.toCamelCase=function(e){return e?e.charAt(0).toLowerCase()+e.substring(1):e},O.toPascalCase=function(e){return e?e.charAt(0).toUpperCase()+e.substring(1):e},O.sanitize=function(e){if(e.responseStatus)return e;if(e.errors)return e;var t={};for(var r in e)e.hasOwnProperty(r)&&(e[r]instanceof Object?t[O.toCamelCase(r)]=O.sanitize(e[r]):t[O.toCamelCase(r)]=e[r]);if(t.errors=[],null!=e.Errors)for(var n=0,o=e.Errors.length;n<o;n++){var i=e.Errors[n],s={};for(var a in i)s[O.toCamelCase(a)]=i[a];t.errors.push(s)}return t},O.nameOf=function(e){if(!e)return"null";if("function"==typeof e.getTypeName)return e.getTypeName();var t=e&&e.constructor;if(null==t)throw e+" doesn't have constructor";if(t.name)return t.name;var r=t.toString();return r.substring(9,r.indexOf("("))},O.css=function(e,t,r){for(var n="string"==typeof e?document.querySelectorAll(e):e,o=0;o<n.length;o++){var i=n[o];null!=i&&null!=i.style&&(i.style[t]=r)}},O.splitOnFirst=function(e,t){if(!e)return[e];var r=e.indexOf(t);return 0<=r?[e.substring(0,r),e.substring(r+1)]:[e]},O.splitOnLast=function(e,t){if(!e)return[e];var r=e.lastIndexOf(t);return 0<=r?[e.substring(0,r),e.substring(r+1)]:[e]};var x=function(e){return"string"!=typeof e?e:e.replace(/([A-Z]|[0-9]+)/g," $1").replace(/_/g," ").trim()};O.humanize=function(e){return!e||0<=e.indexOf(" ")?e:x(e)},O.queryString=function(e){if(!e||-1===e.indexOf("?"))return{};for(var t=O.splitOnFirst(e,"?")[1].split("&"),r={},n=0;n<t.length;++n){var o=t[n].split("=");r[o[0]]=1<o.length?decodeURIComponent(o[1].replace(/\+/g," ")):null}return r},O.combinePaths=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,n,o=[];for(r=0,n=e.length;r<n;r++){var i=e[r];o=-1===i.indexOf("://")?o.concat(i.split("/")):o.concat(i.lastIndexOf("/")===i.length-1?i.substring(0,i.length-1):i)}var s=[];for(r=0,n=o.length;r<n;r++){var a=o[r];a&&"."!==a&&(".."===a?s.pop():s.push(a))}return""===o[0]&&s.unshift(""),s.join("/")||(s.length?"/":".")},O.createPath=function(e,t){var r={};for(var n in t)r[n.toLowerCase()]=n;for(var o=e.split("/"),i="",s=0;s<o.length;s++){var a=o[s];if(null==a&&(a=""),"{"===a[0]&&"}"===a[a.length-1]){var u=r[a.substring(1,a.length-1).toLowerCase()];u&&(a=t[u],delete t[u])}0<i.length&&(i+="/"),i+=a}return i},O.createUrl=function(e,t){var r=O.createPath(e,t);return O.appendQueryString(r,t)},O.appendQueryString=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e+=0<=e.indexOf("?")?"&":"?",e+=r+"="+I(t[r]));return e};var I=function(e){return null==e?"":"undefined"!=typeof Uint8Array&&e instanceof Uint8Array?O.bytesToBase64(e):encodeURIComponent(e)||""};O.bytesToBase64=function(e){for(var t,r=(3-e.length%3)%3,n="",o=e.length,i=0,s=0;s<o;s++)t=s%3,i|=e[s]<<(16>>>t&24),2!=t&&e.length-s!=1||(n+=String.fromCharCode(L(i>>>18&63),L(i>>>12&63),L(i>>>6&63),L(63&i)),i=0);return 0==r?n:n.substring(0,n.length-r)+(1==r?"=":"==")};var L=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},P="function"==typeof btoa?btoa:function(e){return new Buffer(e).toString("base64")};k.toBase64=function(e){return P(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(new Number("0x"+t).valueOf())}))},O.stripQuotes=function(e){return e&&'"'==e[0]&&'"'==e[e.length]?e.slice(1,-1):e},O.tryDecode=function(t){try{return decodeURIComponent(t)}catch(e){return t}},O.parseCookie=function(e){if(!e)return null;for(var t=null,r=e.split(/; */),n=0;n<r.length;n++){var o=r[n],i=O.splitOnFirst(o,"="),s=i[0].trim(),a=1<i.length?O.tryDecode(O.stripQuotes(i[1].trim())):null;if(0==n)t={name:s,value:a,path:"/"};else{var u=s.toLowerCase();"httponly"==u?t.httpOnly=!0:"secure"==u?t.secure=!0:"expires"==u?(t.expires=new Date(a),"Invalid Date"===t.expires.toString()&&(t.expires=new Date(a.replace(/-/g," ")))):t[s]=a}}return t},O.normalizeKey=function(e){return e.toLowerCase().replace(/_/g,"")};var N=function(e){return"[object Array]"===Object.prototype.toString.call(e)};function F(){var e=this.responseStatus||this.ResponseStatus;if(null!=e){var t=e.ErrorCode?O.sanitize(e):e;return t.errors&&0!=t.errors.length?void 0:t.message||t.errorCode}}function M(e){var t=this.responseStatus||this.ResponseStatus;if(null!=t){var r=t.ErrorCode?O.sanitize(t):t,n=O.toVarNames(e);if(n&&null!=r.errors&&0!=r.errors.length){for(var o=n.map(function(e){return(e||"").toLowerCase()}),i=0,s=r.errors;i<s.length;i++){var a=s[i];if(-1!==o.indexOf((a.fieldName||"").toLowerCase()))return}for(var u=0,l=r.errors;u<l.length;u++){a=l[u];if(-1===o.indexOf((a.fieldName||"").toLowerCase()))return a.message||a.errorCode}}return r.message||r.errorCode||void 0}}O.normalize=function(e,t){if(N(e)){if(!t)return e;for(var r=[],n=0;n<e.length;n++)r[n]=O.normalize(e[n],t);return r}if("object"!=typeof e)return e;var o={};for(var i in e)o[O.normalizeKey(i)]=t?O.normalize(e[i],t):e[i];return o},O.getField=function(e,t){return null==e||null==t?null:e[t]||e[Object.keys(e).filter(function(e){return O.normalizeKey(e)===O.normalizeKey(t)})[0]||""]},O.parseResponseStatus=function(t,r){void 0===r&&(r=null);try{var e=JSON.parse(t);return O.sanitize(e.ResponseStatus||e.responseStatus)}catch(e){return{message:r||e.message||e,__error:{error:e,json:t}}}},O.toFormData=function(e){if("undefined"!=typeof window){var t=new FormData;for(var r in e)t.append(r,e[r]);return t}},O.toObject=function(e){var t=this,r={};if(!e)return r;if("object"!=typeof e)throw new Error("keys must be an Array of object keys");return Array.prototype.slice.call(e).forEach(function(e){t[e]&&(r[e]=t[e])}),r},O.errorResponseSummary=F,O.errorResponseExcept=M,O.errorResponse=function(t){if(null==t)return F.call(this);var e=this.responseStatus||this.ResponseStatus;if(null!=e){var r=e.ErrorCode?O.sanitize(e):e;if(null!=r.errors&&0!=r.errors.length){var n=r.errors.find(function(e){return(e.fieldName||"").toLowerCase()==t.toLowerCase()});return n?n.message||n.errorCode:void 0}}},O.toDate=function(e){return e?"function"==typeof e.getMonth?e:"/"==e[0]?new Date(parseFloat(/Date\(([^)]+)\)/.exec(e)[1])):new Date(e):null},O.toDateFmt=function(e){return O.dateFmt(O.toDate(e))},O.padInt=function(e){return e<10?"0"+e:e},O.dateFmt=function(e){return void 0===e&&(e=new Date),e.getFullYear()+"/"+O.padInt(e.getMonth()+1)+"/"+O.padInt(e.getDate())},O.dateFmtHM=function(e){return void 0===e&&(e=new Date),e.getFullYear()+"/"+O.padInt(e.getMonth()+1)+"/"+O.padInt(e.getDate())+" "+O.padInt(e.getHours())+":"+O.padInt(e.getMinutes())},O.timeFmt12=function(e){return void 0===e&&(e=new Date),O.padInt((e.getHours()+24)%12||12)+":"+O.padInt(e.getMinutes())+":"+O.padInt(e.getSeconds())+" "+(12<e.getHours()?"PM":"AM")};var A=function(e){return'<div class="alert alert-danger">'+e+"</div>"},D=function(e,t){return e.getAttribute(t)},j=function(e,t,r){return e.setAttribute(t,r)},q=function(e,t){return e.removeAttribute(t)},B={className:"class",htmlFor:"for"};function H(e,t,r){var n=document.createElement(e);if(r)for(var o in r)j(n,B[o]||o,r[o]);return t&&t.insertAfter&&t.insertAfter.parentNode.insertBefore(n,t.insertAfter.nextSibling),n}function z(){var e=D(this,"data-invalid");if(e){var t="checkbox"===this.type||"radio"===this.type||_(this,"form-check"),r=t?function(e,t){for(;null!=e&&!_(e,t);)e=e.parentElement;return e}(this,"form-check"):null;t?J(r||this.parentElement,"is-invalid form-control"):J(this,"is-invalid");var n=this.nextElementSibling,o=!n||D(n,"for")!==this.id&&"SMALL"!==n.tagName?this:t?r||n.parentElement:n;(null!=o&&o.nextElementSibling&&_(o.nextElementSibling,"invalid-feedback")?o.nextElementSibling:H("div",{insertAfter:o},{className:"invalid-feedback"})).innerHTML=e}}O.createElement=H;var _=function(e,t){return!!e&&(e.classList?e.classList.contains(t):-1<(" "+e.className+" ").replace(/[\n\t\r]/g," ").indexOf(" "+t+" "))},J=function(e,t){return e?e.classList?(r=e.classList).add.apply(r,t.split(" ")):_(e,t)?null:e.className=(e.className+" "+t).trim():null;var r},G=function(e,t){return e?e.classList?e.classList.remove(t):_(e,t)?e.className=e.className.replace(/(\s|^)someclass(\s|$)/," "):null:null};O.bootstrap=function(e){for(var t=(e||document).querySelectorAll("[data-invalid]"),r=0;r<t.length;r++)z.call(t[r])},"undefined"!=typeof window&&void 0!==window.Element&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null})),O.bindHandlers=function(u,e){void 0===e&&(e=document),e.addEventListener("click",function(e){var t=e.target,r=D(t,"data-click");if(!r){var n=t.closest("[data-click]");n&&(r=D(n,"data-click"))}if(r){var o=r.indexOf(":");if(0<=o){var i=r.substring(0,o),s=r.substring(o+1);(a=u[i])&&a.apply(e.target,s.split(","))}else{var a;(a=u[r])&&a.apply(e.target,[].slice.call(arguments))}}})};var Q={overrideMessages:!(O.bootstrapForm=function(t,r){t&&(r.model&&te(t,r.model),t.onsubmit=function(e){return e.preventDefault(),r.type="bootstrap-v4",V(t,r)})}),messages:{NotEmpty:"Required",NotNull:"Required",Email:"Invalid email",AlreadyExists:"Already exists"},errorFilter:function(e,t,r){return this.overrideMessages?this.messages[t]||e||x(t):e||x(t)}};function W(e){G(e,"has-errors");var t=e.querySelectorAll.bind(e);t(".error-summary").forEach(function(e){e.innerHTML="",e.style.display="none"}),t("[data-validation-summary]").forEach(function(e){e.innerHTML=""}),t(".error").forEach(function(e){return G(e,"error")}),t(".form-check.is-invalid [data-invalid]").forEach(function(e){q(e,"data-invalid")}),t(".form-check.is-invalid").forEach(function(e){return G(e,"form-control")}),t(".is-invalid").forEach(function(e){G(e,"is-invalid"),q(e,"data-invalid")}),t(".is-valid").forEach(function(e){return G(e,"is-valid")})}var K={MultiPart:"multipart/form-data",UrlEncoded:"application/x-www-form-urlencoded",Json:"application/json"};function $(e){void 0===e&&(e={});var t,r=this,n=D(r,"enctype")||K.UrlEncoded;if(n==K.MultiPart&&void 0===window.FormData)throw new Error("FormData Type is needed to send '"+K.MultiPart+"' Content Types");try{t=X(r,n)}catch(e){throw new Error(""+(e.message||e))}var o=new Headers;o.set("Accept",K.Json),o.set("Content-Type",n);var i={method:D(r,"method")||"POST",credentials:"include",mode:"cors",headers:o,body:t};return e.requestFilter&&e.requestFilter(i),fetch(new Request(e.url||D(r,"action"),i)).catch(function(e){throw new Error("Network is unreachable ("+(e.message||e)+")")}).then(function(t){return e.responseFilter&&e.responseFilter(t),t.ok?(function(e,t){var r=t.headers.get("X-Location");r&&(location.href=r);var n=t.headers.get("X-Trigger");if(n){var o=n.indexOf(":"),i=0<=o?n.substring(0,o):n,s=0<=o?n.substring(o+1):null;ee(e,i,s?[s]:[])}}(r,t),function(e){var t=e.headers.get("content-type"),r=t&&-1!==t.indexOf(K.Json);if(r)return e.json();var n=e.headers.get("content-length");return"0"===n||null==n&&!r?null:e.json()}(t)):t.json().catch(function(e){throw new Error("The request failed with "+(t.statusText||t.status))}).then(function(e){throw Object.assign.apply(Object,[new s].concat(O.sanitize(e)))})})}function V(o,i){void 0===i&&(i={});var s="bootstrap-v4"===i.type;W(o);try{if(i.validate&&!1===i.validate.call(o))return!1}catch(e){return!1}var a=o.querySelectorAll.bind(o);J(o,"loading");var e=null==i.onSubmitDisable?"[type=submit]":i.onSubmitDisable,t=null!=e&&""!=e;function r(e,t){if(void 0===t&&(t=null),t)!function(e,n,t){if(W(e),n){n=O.sanitize(n),J(e,"has-errors");var s=t&&"bootstrap-v4"===t.type,r=__assign({},Q,t);t.messages&&(r.overrideMessages=!0);var o=r.errorFilter.bind(r),i=n.errors,a=e.querySelectorAll.bind(e);if(i&&i.length){var u={},l={};a("input,textarea,select,button").forEach(function(e){var t=e,r=t.previousElementSibling,n=t.nextElementSibling,o=("radio"===t.type||"checkbox"===t.type?null:t.id)||D(t,"name");if(o){var i=o.toLowerCase();u[i]=t,s||(_(r,"help-inline")||_(r,"help-block")?l[i]=r:(_(n,"help-inline")||_(n,"help-block"))&&(l[i]=n))}}),a(".help-inline[data-for],.help-block[data-for]").forEach(function(e){var t=D(e,"data-for").toLowerCase();l[t]=e});for(var c=0,f=i;c<f.length;c++){var h=f[c],p=(h.fieldName||"").toLowerCase(),d=u[p];if(d)if(s){var v=D(d,"type");"radio"===v||"checkbox"===v||J(d,"is-invalid"),j(d,"data-invalid",o(h.message,h.errorCode,"field"))}else J(d,"error"),J(d.parentElement,"has-error");var m=l[p];m&&(J(m,"error"),m.innerHTML=o(h.message,h.errorCode,"field"),m.style.display="block")}a("[data-validation-summary]").forEach(function(e){var t=D(e,"data-validation-summary").split(","),r=M.call(n,t);r&&(e.innerHTML=A(r))})}else{var y=o(n.message||x(n.errorCode),n.errorCode,"summary");s?a("[data-validation-summary]").forEach(function(e){return e.innerHTML="<"===y[0]?y:A(y)}):a(".error-summary").forEach(function(e){e.innerHTML=y,e.style.display="block"})}}}(o,t.ResponseStatus||t.responseStatus,__assign({},i));else if(e){J(o,"has-errors");var r=a(".error-summary")[0];if(r&&(r.innerHTML=e),s){var n=a("[data-validation-summary]")[0];n&&(n.innerHTML=A(e))}}i.error&&i.error.call(o,t),s&&a("[data-invalid]").forEach(function(e){return z.call(e)})}return t&&a(e).forEach(function(e){j(e,"disabled","disabled")}),(i.submit||$).call(o,i).then(function(e){return i.success&&i.success.call(o,e),!1}).catch(function(e){e.responseStatus?r(null,e):r(""+(e.message||e),null)}).finally(function(){G(o,"loading"),t&&a(e).forEach(function(e){q(e,"disabled")}),i.complete&&i.complete.call(o)})}function X(e,t){return void 0===t&&(t=null),t===K.MultiPart?new FormData(e):t==K.Json?JSON.stringify(O.serializeToObject(e)):Z(e)}function Y(e,t,r){for(var n,o=e,i=o.elements.length,s=0;s<i;s++)if((n=o.elements[s]).name&&!n.disabled&&"file"!=n.type&&"reset"!=n.type&&"submit"!=n.type&&"button"!=n.type)if("select-multiple"==n.type)for(var a=o.elements[s].options.length-1;0<=a;a--)n.options[a].selected&&r(t,n.name,n.options[a].value);else("checkbox"!=n.type&&"radio"!=n.type||n.checked)&&r(t,n.name,n.value);return t}function Z(e){return Y(e,[],function(e,t,r){return"string"==typeof r?e.push(encodeURIComponent(t)+"="+encodeURIComponent(r)):null}).join("&").replace(/%20/g,"+")}function ee(e,t,r){if(void 0===r&&(r=null),document.createEvent){(n=document.createEvent("click"==t||t.startsWith("mouse")?"MouseEvents":"HTMLEvents")).initEvent(t,!0,!0),n.data=r,e.dispatchEvent(n)}else{var n=document.createEventObject();e.fireEvent("on"+t,n)}}function te(e,t){if(t){var r;for(var n in t){var o=t[n];null==o&&(o="");var i=e.elements.namedItem(n)||e.elements.namedItem((r=n)?r[0]===r[0].toUpperCase()?O.toCamelCase(r):r[0]===r[0].toLowerCase()?O.toPascalCase(r):r:r),s=i;if(i)switch(s.type||i[0].type){case"radio":case"checkbox":for(var a=i.length,u=0;u<a;u++)i[u].checked=-1<o.indexOf(i[u].value);break;case"select-multiple":var l=N(o)?o:[o],c=i;for(u=0;u<c.options.length;u++)c.options[u].selected=-1<l.indexOf(c.options[u].value);break;case"select":case"select-one":s.value=o.toString()||o;break;case"date":var f=O.toDate(o);f&&(s.value=f.toISOString().split("T")[0]);break;default:s.value=o}}}}O.toVarNames=function(e){return e?N(e)?e:e.split(",").map(function(e){return e.trim()}):[]},O.formSubmit=$,O.ajaxSubmit=V,O.serializeForm=X,O.serializeToObject=function(e){return Y(e,{},function(e,t,r){return e[t]=r})},O.serializeToUrlEncoded=Z,O.serializeToFormData=function(e){return Y(e,new FormData,function(e,t,r){return e.append(t,r)})},O.triggerEvent=ee,O.populateForm=te});